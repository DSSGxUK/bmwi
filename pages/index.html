<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>network of kreise</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
</head>

<body>
    <script src="https://d3js.org/d3.v3.js"></script>
    <div class="col center-block" id = "gg"></div>
    <script>
      
//Constants for the SVG
var width = 1000,
  height = 800;

//Set up the colour scale
var color = d3.scale.category20b();

//Set up the force layout
var force = d3.layout
  .force()
  .charge(-480)
  .linkDistance(100)
  .size([width, height]);

//Append a SVG to the body of the html page. Assign this SVG as an object to svg
var svg = d3
  .select("#gg")
  .append("svg")
  .attr("width", width)
  .attr("height", height);

//Read the data from data.json
//d3.json("{{ url_for('static', filename= 'assets/data/')}}{{SCHOOL_ + '.json' }}", function (data) {
d3.json("network.json", function (data) {
  force.nodes(data.nodes).links(data.links).start();

  var link = svg
    .selectAll(".link")
    .data(data.links)
    .enter()
    .append("line")
    .attr("class", "link")
    .style("stroke-width", function (d) {
      return Math.sqrt(d.value);
    });

  var node = svg
    .selectAll(".node")
    .data(data.nodes)
    .enter()
    .append("g")
    .attr("class", "node")
    .call(force.drag);

  node
    .append("circle")
    .attr("stroke", "black")
    .attr("stroke-width", 1)
    .attr("r", function (d) {
      //return d.size / 10;
      return Math.sqrt(d.size) * 3;
    })
    .style("fill", function (d) {
      return color(d.group);
    })
    .on('click', function(d,i) {
        if (event.defaultPrevented) return;
        window.open("/" + d.name)
    
      })

    

  node
        .append("text")
        .attr("dx", function (d) {
        //return d.size / 10;
        return Math.sqrt(d.size) * 3 + 5;
        })
        .attr("dy", ".35em")
        .text(function (d) {
        return d.name;
        })
        
    ;

  force.on("tick", function () {
    link
      .attr("x1", function (d) {
        return d.source.x;
      })
      .attr("y1", function (d) {
        return d.source.y;
      })
      .attr("x2", function (d) {
        return d.target.x;
      })
      .attr("y2", function (d) {
        return d.target.y;
      });

    //Changed

    d3.selectAll("circle")
      .attr("cx", function (d) {
        return d.x;
      })
      .attr("cy", function (d) {
        return d.y;
      });

    d3.selectAll("text")
      .attr("x", function (d) {
        return d.x;
      })
      .attr("y", function (d) {
        return d.y;
      });

    //End Changed
  });
});
</script>

</body>

</html>