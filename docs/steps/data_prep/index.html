<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://example.com/steps/data_prep/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Data Prep - BMWi Forecasting Tool</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Prep";
    var mkdocs_page_input_path = "steps\\data_prep.md";
    var mkdocs_page_url = "/steps/data_prep/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> BMWi Forecasting Tool</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../start/start/">Start Here</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../start/user/">User Workflow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../start/quick/">Quick Access</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Step-by-Step Guide</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Data Prep</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#time-series-data-excel-workbook">Time-series data excel workbook</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#upload-excel-workbook">Upload Excel Workbook</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#select-data-to-clean">Select data to clean</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#select-variable">Select variable</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#select-data-format">Select data format</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#long-format">Long format</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#wide-format">Wide format</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#final-dataset-cleaning">Final dataset cleaning</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#loading-dataset">Loading dataset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cropping-timeframe">Cropping timeframe</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../model/">Predictions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ci/">Confidence intervals</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../visualizations/">Visualizations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rankings/">Rankings</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../error/">Error Analysis</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Advanced Features</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced/tech_flow/">Technical Workflow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced/installation/">Installation and Setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced/cleanerclass/">Cleaner Class</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Our Journey</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../journey/models/">Models</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../journey/clusters/">Clusters</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../journey/covid19/">Covid19 restrictions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../journey/GDP/">GDP and Unemployment rate</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">About</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/tool/">Tool</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/project/">Project</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/team/">Team</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/licenses/">Licences</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">BMWi Forecasting Tool</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Step-by-Step Guide &raquo;</li>
        
      
    
    <li>Data Prep</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="data-prep">Data Prep</h1>
<p>Upload the dataset and make any necessary changes to fit the prediction model. You can find a </p>
<!-- ## Reshape and merge datasets -->

<!-- This section process data differently for excel or csv files, and for time-series or structural data type. It assumes that:

- **time-series** data are in **wide**-format **excel** workbooks, where each worksheet contains data for one variable

- **structural** data are in **long**-format **csv** files, where each row is a record of one kreis, and each column is one variable

- both assumes to have one column containing the kreis-level area code `ags5` ("amtlicher gemeindeschlüssel") -->

<p>This section processes the excel file that is inputted. The excel file must contain time-series data adhering to the following rules: </p>
<ul>
<li>data should be in <strong>wide</strong>-format (the columns are different timestamps, rows are kreise)</li>
<li>one sheet cannot have more than one variable (e.g., unemployment rate)</li>
<li>have one column containing the kreis-level area code <code>ags5</code> ("amtlicher gemeindeschlüssel")</li>
</ul>
<h2 id="time-series-data-excel-workbook">Time-series data excel workbook</h2>
<!-- ### Error Handling

![error 1](../prep_screenshots/error1.png)

When you open up the page, you will likely be facing this error. No worries, that just means you haven't uploaded a data yet! -->

<h3 id="upload-excel-workbook">Upload Excel Workbook</h3>
<p><img alt="export excel workbook" src="../prep_screenshots/export_excel.JPG" /></p>
<p><span style="color:gray"><em>When you confirm that you are using an excel workbook containing time-series data, you are prompted to upload the data. In this sample screenshot, you can see that the file <a href="../../data/7444_318010_BMWI_Enkelmann_Eckdaten_Zeitreihe_Kreise.xlsx">"7444_318010_BMWI_Enkelmann_Eckdaten_Zeitreihe_Kreise.xlsx"</a> is being uploaded.</em></span></p>
<h3 id="select-data-to-clean">Select data to clean</h3>
<!-- Because each data is formatted differently in the excel workbook, we created different cleaners for different data. Select the appropriate cleaner based on the data input. Currently, we support:  -->

<!-- ![select cleanerclass](../prep_screenshots/select_cleaner.png) -->

<!-- - `Unemployment rate` (labor market data, containing unemployment rate information)  -->

<p><img alt="unemployment rate data" src="../prep_screenshots/alq_data.png" /></p>
<p><i></p>
<p style="color:gray">This is the assumed workbook for labor market data:</p>
<ul style="color:gray">
    <li> The index column "Region" shows that each row is a record of one kreis.
    <li> The rest of the columns should represent each year and month.
    <li> Each worksheet represents a different variable. For example, the current worksheet selected is "Alo_Quote", which stands for unemployment rate ("Arbeitslosenquote"). 
    <li> It is important that there is a sheet which is called "Alo_Quote" which contain the unemployment rate data. 
</ul>
<p></i></p>
<!-- - `GDP` (GDP data, containing kreis-level GDP breakdown)

![gdp data](../prep_screenshots/gdp_data.png)

<i>
<p style="color:gray">This is the assumed workbook for GDP data:</p>
<ul style="color:gray">
    <li> The index column is "Regional-schlüssel". We are looking for the ones with 5 numbers, which means they are on the kreis-level (corresponding to the "NUTS 3" column).
    <li> The rest of the columns should represent each year.
    <li> Each worksheet represents a different variable. For example, the current worksheet selected is "1.1", which according to the trailing title means gross domestic product ("bruttoinlandsprodukt"). 
</ul>
</i> -->

<h3 id="select-variable">Select variable</h3>
<p><img alt="select variable" src="../prep_screenshots/select_var.png" /></p>
<p><span style="color:gray"><em>The default variable is set to "unemployment rate".</em></span></p>
<!-- <span style="color:gray">*Choose at least one variable. Choosing no variables at all would result in the IndexError above.*</span> -->

<h3 id="select-data-format">Select data format</h3>
<p><img alt="select data format" src="../prep_screenshots/select_format.png" /></p>
<h4 id="long-format">Long format</h4>
<p><img alt="long format one variable" src="../prep_screenshots/long_one.png" /></p>
<p><span style="color:gray"><em>This is an example of a single-variable "long" format data. The dataframe contains three columns: the kreis code (<code>ags5</code>), the time (<code>date</code>), and the variable (e.g. <code>Alo Quote</code>). The number of rows of this file is 401 kreis * #dates for each kreis.</em></span></p>
<h4 id="wide-format">Wide format</h4>
<p><img alt="wide format one variable" src="../prep_screenshots/wide_one.png" /></p>
<p><span style="color:gray"><em>This is an example of a single-variable "wide" format data. All the columns in the dataframe are dates. The index of the dataframe is the <code>ags5</code> code. The number of rows of this file should be 401.</em></span></p>
<!-- ### Merging

#### Long formats merged to one wide format

![long merged wide format](../prep_screenshots/long_merge.png)

<span style="color:gray">*Merging multiple so-called long-format-single-variable data together results in a commonly-knwown "wide format" merged file as shown above. `ags5` and `date` are the index columns. Each column afterwards represents a variable. In this example, the two columns are `SvB_AO` (Sozialversicherungspflichtig Beschäftigte -- Arbeitsort) and `Alo_Quote` (Arbeitslosenquote).*</span>

#### Wide formats merged to one long format

![wide merged long format](../prep_screenshots/wide_merge.png)

<span style="color:gray">*Merging multiple so-called wide-format-single-variable data together results in a commonly-known "long format" merged file as shown above. `ags5` and `variable` are the index columns. Each column afterwards represents a date. In this example, the two variables are `SvB_AO` and `Alo_Quote`, and they are indicated in the `variable` column.*</span>

#### Confirm merge

![confirm merge](../prep_screenshots/confirm_merge.png)

<span style="color:gray">*A preview of the merged data would be shown like the long and wide formats above. Once you confirm to use the merged data, it would be set as the default loaded dataset on the tool.*</span> -->

<!-- ## Structural data csv files

![csv](../prep_screenshots/csv.png)

<span style="color:gray">*This is a sample of a csv file the tool expects. It should at least contain `ags5`, but could also include metadata such as `ags2`, `bundesland`, `kreis` etc. Each column afterwards is a varaible.*</span>

![merge csv](../prep_screenshots/csv_merge.png)

<span style="color:gray">*A simple merge using the `ags5` column, we have a merged file of 401 rows, and the combination of all the selected columns. In this example, we merged two files, `raumordnung` and `point_of_interest`. Again, a preview of the merged file would be shownn, and once confirmed, it would be the default loaded dataset.*</span> -->

<h2 id="final-dataset-cleaning">Final dataset cleaning</h2>
<p>Data cleaning such as cropping to a certain dataframe, checking for NaN data etc.</p>
<h3 id="loading-dataset">Loading dataset</h3>
<p><img alt="csv" src="../prep_screenshots/load_clean.png" /></p>
<p><span style="color:gray"><em>Here, you load the data you would like to clean. By default, it loads the data that you have confirmed processing and merging in the last section.</em></span></p>
<h3 id="cropping-timeframe">Cropping timeframe</h3>
<p><strong>Pro Tip</strong>: The purpose of cropping the appropriate timeframe helps differentiate between a normal-time and crisis-time model. For example, we know that there was the economic crisis around 2008 and the COVID pandemic around 2020. Thus, when doing a normal-time unemployment rate prediction, you could crop out those times so that the model is only learning the pattern from normal-time data.</p>
<p><img alt="csv" src="../prep_screenshots/crop_time.png" /></p>
<p><span style="color:gray"><em>This is where you can select the timeframe you would like to feed into the model. In this example, a timeframe between 2007-05 and 2007-07 is selected and shown in the preview. Again, once you confirm the dataset, it would be automatically loaded in the model on the next page.</em></span></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../model/" class="btn btn-neutral float-right" title="Predictions">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../start/quick/" class="btn btn-neutral" title="Quick Access"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../start/quick/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../model/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
